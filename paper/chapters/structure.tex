%!TEX root = ../main.tex

\section{Project structure}

The structure of setlx2py follows the one of a typical Python module. In addition to that, \texttt{nosetest} is used for unit testing, which also demands a specific naming of the test folder and respective test files.

\begin{figure}[ht]
	\dirtree{%
	.1 /setlx2py.
	.2 setlx2py.
	.3 __init__.py.
	.3 setlx_ast.cfg.
	.3 setlx_ast.py.
	.3 setlx_transformer.py.
	.3 setlx_builtin.py.
	.3 setlx_codegen.py.
	.3 setlx_lexer.py.
	.3 setlx_parser.py.
	.3 setlx_semcheck.py.
	.3 setlx_util.py.
	.3 builtin.
	.4 __init__.py.
	.4 setlx_functions.py.
	.4 setlx_internals.py.
	.4 setlx_list.py.
	.4 setlx_set.py.
	.4 setlx_string.py.
	.2 tests.
	.3 test_ast_transform.py.
	.3 test_builtin.py.
	.3 test_codegen.py.
	.3 test_execution.py.
	.3 test_lexer.py.
	.3 test_list.py.
	.3 test_parsable.py.
	.3 test_parser.py.
	.3 test_set.py.
	}
\caption{Folders and files in setlx2py}
\end{figure}

%
% SUBSECTION
%
\clearpage
\subsection{Source code}

When writing Python modules, the name of the folder where source files reside is the name of the module itself. That means, setlx2py files are imported with (as an example with setlx\_util)

\begin{lstlisting}{style=MyPython, language=python}
from setlx2py.setlx_util import *
\end{lstlisting}

%
\subsubsection{setlx\_cfg}

The config file from which the AST Python code is generated. The process is explained in Section \ref{sec:ast}.

%
\subsubsection{setlx\_ast}

This file contains the AST nodes used to represent a SetlX program internally. It is automatically generated from setlx\_ast.cfg and should not be altered by hand.

%
\subsubsection{setlx\_transformer}

This file defines the transformations which are made to the AST after it is generated by the parser. The process is explained in Section \ref{sec:transformer}.

%
\subsubsection{setlx\_builtin}
This folder holds all dependencies needed to actually run a file generated by setlx2py.

%
\subsubsection{setlx\_codegen}

This file contains the code generator, which takes in an AST and outputs Python code. The process is explained in Section \ref{sec:codegen}.

%
\subsubsection{setlx\_lexer}

This file contains the lexer, which also contains the token definitions. It is used in the parser, which drives the lexing. The lexer is written with the PLY framework.

%
\subsubsection{setlx\_parser}

This file contains the parser and the SetlX grammar. It reads in a SetlX program as a string and outputs an AST. It internally uses the lexer. The parser is written with the PLY framework.

%
\subsubsection{setlx\_semcheck}

This file contains all functions to semantically check the generated sub-AST inside certain grammar rules in the parser. This is needed, since the grammar allows too much due to its LALR nature.

%
\subsubsection{setlx\_util}

Central location to keep all functions which are called from at least to different files.

%
% SUBSECTION
%
\clearpage
\subsection{Test files}

Nosetest, the test framework used, requires a folder named \texttt{tests}. Files prefixed with -inter alia- \texttt{test\_} are  test files. All files not recognized as test files are ignored when tests are run. The following paragraphs briefly describe the tests whose function is not directly obvious.

%
\subsubsection{test\_builtin}

Contains tests for the builtin functions.

%
\subsubsection{test\_execution}

Contains acceptance tests for the code generation. It is tested whether the execution of setlx2py-generated code yields the same result as the standard SetlX interpreter.
%
\subsubsection{test\_list, test\_set \& test\_string }

Tests for the three main data structures used in SetlX.

%
\subsubsection{test\_parsable}

Contains acceptance tests for the parser. It is tested whether setlx2py can parse all the example SetlX code.